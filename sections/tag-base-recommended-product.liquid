{% schema %}
{
  "name": "Related Products",
  "settings": [
    {
      "type": "text",
      "label": "Custom Metafield Condition",
      "id": "custom_metafield_condition",
      "default": "your_condition_here"
    }
  ],
  "presets": [
    {
      "name": "Related Products",
      "category": "Products"
    }
  ]
}
{% endschema %}

{% comment %}
    This code section displays 4 related products based on the vendor, collection,
    and a custom metafield condition.
{% endcomment %}

{% assign current_vendor = product.vendor %}
{% assign current_collection = product.collections.first %}
{% assign custom_metafield_condition = section.settings.custom_metafield_condition | default: 'your_condition_here' %}

{% assign related_products = collections["all"].products | where: 'vendor', current_vendor | where: custom_metafield_condition %}

{% for related_product in related_products limit: 4 %}
  <div class="related-product">
    <h3>{{ related_product.title }}</h3>
    <!-- Add other product details as needed -->
  </div>
{% endfor %}