{% schema %}
{
  "name": "Recommended products",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Recommended products"
    },
    {
      "type": "text",
      "id": "related_tag",
      "label": "Tag",
      "info" : "The tag determines which products show as related products."
    },
    {
      "type": "select",
      "id": "number_of_products",
      "label": "Number of products to show",
      "default": "4",
      "options": [
        {
          "value": "4",
          "label": "4"
        },
        {
          "value": "8",
          "label": "8"
        },
        {
          "value": "12",
          "label": "12"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Recommended products"
    }
  ]
}
{% endschema %}

<h3>Related Product</h3>


{% assign vendor = product.vendor %}
{% assign product_handle = product.handle %}
handel is {{ product.vendor }}
{% assign counter = '' %}
<div class"grid grid--uniform grid--view-items">
{% for product in collections['all'].all_products %}
 {% if  vendor == product.vendor | product.metafields.custom.sub_category_1 | counter.size < 4 and product_handle != product.handle %}
 {% capture temp %}{{ counter }}*{% endcapture %}
 {% assign counter = temp %}
 <div style="float:left;width:30%;padding:1%;">
 <a href="{{ product.url | within: collection }}" title="{{ product.title }}">
 <img src="{{ product.images.first | product_img_url: 'medium' }}" alt="{{ product.title }}" />
 </a>
 <h3>{{ product.title }}</h3>
 product vender :{{ product.vendor }}
 product sub category : {{ product.metafields.custom.sub_category_1}}
 <h3>{{ product.price }}</h3>
 </div>
{% endif %}
{% endfor %}
</div>


{% assign current_vendor = product.vendor %}
{% assign current_collection = product.collections.first %}
{% assign custom_metafield_condition = product.metafields.custom.sub_category_1 %}

{% assign related_products =custom_metafield_condition %}

{% for related_product in related_products limit: 4 %}
  <div class="related-product">
    <h3>{{ related_product.title }}</h3>
    <!-- Add other product details as needed -->
  </div>
{% endfor %}